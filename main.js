!function(){"use strict";class e{constructor(e,t){this._formElement=t,this._inputSelector=e.inputSelector,this._savebuttonSelector=e.saveButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_toggleInputError(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}resetValidation(){this._inputList.forEach((e=>{this._toggleInputError(e)}))}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_setEventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(".popup__save"),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputError(e),this.toggleButtonState(this._buttonElement)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class t{constructor(e,t){let{data:r,handleImageClick:s,handleDeleteConfirmation:i,confirmationFunction:n,handleLikeFunction:o,onLoadLikeCheck:a}=e;this._title=r.name,this._image=r.link,this._likeAmount=r.likes,this._cardOwnerId=r.owner._id,this._cardId=r._id,this._templateSelector=t,this._handleImageClick=s,this._handleDeleteConfirmation=i,this._confirmationFunction=n,this._handleLikeFunction=o,this._onLoadLikeCheck=a}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0)}removeCard(){this._element.remove()}likeNumberCheck(e){Number(e?++this._likeNumber.textContent:--this._likeNumber.textContent)}generateCard(){return this._element=this._getTemplate(),this._setEventHandlers(),this._cardImage=this._element.querySelector(".card__image"),this._cardTitle=this._element.querySelector(".card__title"),this._likeNumber=this._element.querySelector(".card__like-number"),this._trash=this._element.querySelector(".card__trash"),this._likeButton=this._element.querySelector(".card__like"),this._onLoadLikeCheck(this._likeAmount,this._likeButton),this._likeNumber.textContent=this._likeAmount.length,"5b91ece1271e0a8558fbe8e0"===this._cardOwnerId&&this._trash.classList.add("card__trash_opened"),this._cardImage.src=this._image,this._cardImage.alt=`Photo of ${this._title}`,this._cardTitle.textContent=this._title,this._element}_setEventHandlers(){this._element.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick({title:this._title,image:this._image})})),this._element.querySelector(".card__like").addEventListener("click",(()=>{this._handleLikeFunction(this._cardId,this._likeButton)})),this._element.querySelector(".card__trash").addEventListener("click",(()=>{this._confirmationFunction(this._cardId)}))}}class r{constructor(e){var t,r,s;t=this,s=e=>{"Escape"===e.key&&this.close()},(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(r="_handleEscClose"))in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleClickClose(e){e.target===e.currentTarget&&this.close()}setEventListeners(){this._popup.querySelector(`#${this._popup.id}-close`).addEventListener("click",this.close.bind(this)),this._popup.addEventListener("mousedown",this._handleClickClose.bind(this))}}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class i extends r{constructor(e,t){super(e),s(this,"open",(e=>{e&&this._inputList.forEach((e=>{e.value="Loading..."})),super.open()})),s(this,"close",(()=>{super.close(),setTimeout((()=>{this._form.reset()}),500)})),this._submitFunction=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=this._popup.querySelectorAll(".popup__input"),this._saveButton=this._popup.querySelector(".popup__save")}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setSubmitAction(e){this._submitFunction=e}isLoading(){this._saveButton.textContent="Saving..."}finishLoading(){setTimeout((()=>{this._saveButton.textContent="Save"}),500)}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._submitFunction(this._getInputValues())})),super.setEventListeners()}}class n{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=t}addItem(e){this._container.prepend(this._renderer(e))}renderItems(e){e.forEach((e=>{this._container.append(this._renderer(e))}))}}const o=document.querySelector(".main"),a=o.querySelector(".popup"),l=a.querySelector("#editForm"),c=a.querySelector("#addForm"),u=a.querySelector("#profilePictureForm"),h=o.querySelector(".cards"),_=o.querySelector(".profile"),d=_.querySelector(".profile__edit"),p=_.querySelector(".profile__add"),m=_.querySelector(".profile__image"),v=a.querySelector("#inputName"),f=a.querySelector("#inputDesc"),g=_.querySelector(".profile__title"),E=_.querySelector(".profile__subtitle"),b=_.querySelector(".profile__image"),L=_.querySelector(".profile__picture"),y={formSelector:".popup__form",inputSelector:".popup__input",saveButtonSelector:".popup__save",inactiveButtonClass:"popup__save_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},k=new e(y,l),S=new e(y,c),C=new e(y,u),I=new class extends r{constructor(e){super(e),this._title=this._popup.querySelector(".popup__title"),this._image=this._popup.querySelector(".popup__image")}open(e){this._title.textContent=e.title,this._image.src=e.image,this._image.alt=`An image of ${e.title}.`,super.open()}}("#imagePopup"),q=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_promiseThing(e,t){return Promise.all(e,t)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.imageLink})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addLike(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeLike(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updatePfp(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"3e3670e4-89e4-4b74-ac18-c98464206840","Content-Type":"application/json"}}),P=new class{constructor(e){let{nameElem:t,jobElem:r}=e;this._nameElem=t,this._jobElem=r}getUserInfo(){return info={name:this._nameElem.textContent,about:this._jobElem.textContent}}setUserInfo(e){let{name:t,about:r}=e;this._nameElem.textContent=t,this._jobElem.textContent=r}}({nameElem:g,jobElem:E});q.getUserInfo().then((e=>{P.setUserInfo(e),b.style.backgroundImage=`url(${e.avatar})`})).catch((e=>{console.log(e)})),q.getInitialCards().then((e=>{const r=new n({initialCards:e,renderer:e=>{const r=new t({data:e,handleImageClick:e=>{I.open(e)},confirmationFunction:e=>{j.open(),j.setSubmitAction((()=>{q.deleteCard(e).then((()=>{r.removeCard()}))}))},handleLikeFunction:(e,t)=>{t.classList.contains("card_like_activate")?q.removeLike(e).then((()=>{t.classList.remove("card_like_activate"),r.likeNumberCheck(!1)})).catch((e=>{console.log(e)})):q.addLike(e).then((()=>{t.classList.add("card_like_activate"),r.likeNumberCheck(!0)})).catch((e=>{console.log(e)}))},onLoadLikeCheck:(e,t)=>{e.forEach((e=>{"5b91ece1271e0a8558fbe8e0"===e._id&&t.classList.add("card_like_activate")}))}},"#card");return r.generateCard()}},h),s=new i("#addPopup",(e=>{s.isLoading(),q.addNewCard(e).then((e=>{console.log(e),r.addItem(e)})).catch((e=>{console.log(e)})).finally((()=>{s.finishLoading(),s.close()}))}));s.setEventListeners(),p.addEventListener("click",(()=>{s.open(!1),S.toggleButtonState()})),r.renderItems(e)})).catch((e=>{console.log(e)}));const j=new class extends r{constructor(e){super(e),this._confirmButton=this._popup.querySelector("#certaintyConfirm")}setSubmitAction(e){this._submitFunction=e}setEventListeners(){this._confirmButton.addEventListener("click",(()=>{this._submitFunction(),this.close()})),super.setEventListeners()}}("#certaintyPopup");j.setEventListeners();const w=new i("#editPopup",(e=>{w.isLoading(),q.getUserInfo().then((t=>{P.setUserInfo(t),P.setUserInfo(e)})).catch((e=>{console.log(e)})).finally((()=>{w.finishLoading(),w.close()})),q.setUserInfo(e)}));w.setEventListeners();const $=new i("#profilePicturePopup",(e=>{$.isLoading(),q.updatePfp(e.avatar).then((()=>{b.style.backgroundImage=`url(${e.avatar})`})).catch((e=>{console.log(e)})).finally((()=>{$.finishLoading(),$.close()}))}));$.setEventListeners(),d.addEventListener("click",(()=>{w.open(!0),q.getUserInfo().then((e=>{v.value=e.name,f.value=e.about,k.toggleButtonState(),k.resetValidation()}))})),m.addEventListener("mouseover",(()=>{L.classList.add("profile__picture_active")})),m.addEventListener("mouseout",(()=>{L.classList.remove("profile__picture_active")})),m.addEventListener("click",(()=>{$.open(!1),C.toggleButtonState()})),I.setEventListeners(),k.enableValidation(),S.enableValidation(),C.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFFakJhLFNBQVEsS0FDUEcsRUFBZ0I5RixnQkFDaEI4RixFQUFnQnhILE9BQU8sR0FDdkIsSUFHTndILEVBQWdCaEgsb0JBRWhCc0MsRUFBa0JsRyxpQkFBaUIsU0FBUyxLQUMxQzJLLEVBQWNySCxNQUFLLEdBQ25CMEQsRUFBSTRCLGNBQWNoQixNQUFNdEgsSUFDdEIrRixFQUFVbEMsTUFBUTdELEVBQUtPLEtBQ3ZCeUYsRUFBVW5DLE1BQVE3RCxFQUFLd0ksTUFDdkJsQyxFQUFjeEgsb0JBQ2R3SCxFQUFjcEgsaUJBQWlCLEdBQy9CLElBR0o0RyxFQUFrQnBHLGlCQUFpQixhQUFhLEtBQzlDMEcsRUFBeUIvSCxVQUFVQyxJQUFJLDBCQUEwQixJQUduRXdILEVBQWtCcEcsaUJBQWlCLFlBQVksS0FDN0MwRyxFQUF5Qi9ILFVBQVVLLE9BQU8sMEJBQTBCLElBR3RFb0gsRUFBa0JwRyxpQkFBaUIsU0FBUyxLQUMxQzRLLEVBQWdCdEgsTUFBSyxHQUNyQndELEVBQXdCMUgsbUJBQW1CLElBRzdDMkgsRUFBWW5ELG9CQUVaZ0QsRUFBYzNHLG1CQUVkNEcsRUFBYTVHLG1CQUViNkcsRUFBd0I3RyxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuXHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zYXZlYnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc2F2ZUJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl90b2dnbGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zYXZlXCIpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5fYnV0dG9uRWxlbWVudCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgRm9ybVZhbGlkYXRvciB9O1xyXG4iLCJjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHtcclxuICAgICAgZGF0YSxcclxuICAgICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgICAgaGFuZGxlRGVsZXRlQ29uZmlybWF0aW9uLFxyXG4gICAgICBjb25maXJtYXRpb25GdW5jdGlvbixcclxuICAgICAgaGFuZGxlTGlrZUZ1bmN0aW9uLFxyXG4gICAgICBvbkxvYWRMaWtlQ2hlY2ssXHJcbiAgICB9LFxyXG4gICAgdGVtcGxhdGVTZWxlY3RvclxyXG4gICkge1xyXG4gICAgdGhpcy5fdGl0bGUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZSA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2xpa2VBbW91bnQgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fY2FyZE93bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX2NhcmRJZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbiA9IGhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbjtcclxuICAgIHRoaXMuX2NvbmZpcm1hdGlvbkZ1bmN0aW9uID0gY29uZmlybWF0aW9uRnVuY3Rpb247XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlRnVuY3Rpb24gPSBoYW5kbGVMaWtlRnVuY3Rpb247XHJcbiAgICB0aGlzLl9vbkxvYWRMaWtlQ2hlY2sgPSBvbkxvYWRMaWtlQ2hlY2s7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgfVxyXG5cclxuICBsaWtlTnVtYmVyQ2hlY2soYm9vbGVhbikge1xyXG4gICAgaWYgKGJvb2xlYW4pIHtcclxuICAgICAgTnVtYmVyKCsrdGhpcy5fbGlrZU51bWJlci50ZXh0Q29udGVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBOdW1iZXIoLS10aGlzLl9saWtlTnVtYmVyLnRleHRDb250ZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRIYW5kbGVycygpO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIHRoaXMuX2xpa2VOdW1iZXIgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1udW1iZXJcIik7XHJcbiAgICB0aGlzLl90cmFzaCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190cmFzaFwiKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZVwiKTtcclxuXHJcbiAgICB0aGlzLl9vbkxvYWRMaWtlQ2hlY2sodGhpcy5fbGlrZUFtb3VudCwgdGhpcy5fbGlrZUJ1dHRvbik7XHJcblxyXG4gICAgdGhpcy5fbGlrZU51bWJlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VBbW91bnQubGVuZ3RoO1xyXG5cclxuICAgIGlmICh0aGlzLl9jYXJkT3duZXJJZCA9PT0gXCI1YjkxZWNlMTI3MWUwYTg1NThmYmU4ZTBcIikge1xyXG4gICAgICB0aGlzLl90cmFzaC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fdHJhc2hfb3BlbmVkXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9pbWFnZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHt0aGlzLl90aXRsZX1gO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGl0bGU7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRIYW5kbGVycygpIHtcclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IHRpdGxlOiB0aGlzLl90aXRsZSwgaW1hZ2U6IHRoaXMuX2ltYWdlIH0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZVwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlRnVuY3Rpb24odGhpcy5fY2FyZElkLCB0aGlzLl9saWtlQnV0dG9uKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2hcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY29uZmlybWF0aW9uRnVuY3Rpb24odGhpcy5fY2FyZElkKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBDYXJkIH07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVDbGlja0Nsb3NlKGV2dCkge1xyXG4gICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIGNvbnN0IHBvcHVwQ2xvc2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKGAjJHt0aGlzLl9wb3B1cC5pZH0tY2xvc2VgKTtcclxuICAgIHBvcHVwQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xvc2UuYmluZCh0aGlzKSk7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICBcIm1vdXNlZG93blwiLFxyXG4gICAgICB0aGlzLl9oYW5kbGVDbGlja0Nsb3NlLmJpbmQodGhpcylcclxuICAgICk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBzdWJtaXRGdW5jdGlvbikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9zdWJtaXRGdW5jdGlvbiA9IHN1Ym1pdEZ1bmN0aW9uO1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcclxuICAgIHRoaXMuX3NhdmVCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zYXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgdGhpcy5fc3VibWl0RnVuY3Rpb24gPSBhY3Rpb247XHJcbiAgfVxyXG5cclxuICBpc0xvYWRpbmcoKSB7XHJcbiAgICB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICB9XHJcblxyXG4gIGZpbmlzaExvYWRpbmcoKSB7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gICAgfSwgNTAwKTtcclxuICB9XHJcblxyXG4gIG9wZW4gPSAocHJlZmlsbGVkKSA9PiB7XHJcbiAgICBpZiAocHJlZmlsbGVkKSB7XHJcbiAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgIGlucHV0LnZhbHVlID0gXCJMb2FkaW5nLi4uXCI7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH07XHJcblxyXG4gIGNsb3NlID0gKCkgPT4ge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICB9LCA1MDApO1xyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRGdW5jdGlvbih0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQodGhpcy5fcmVuZGVyZXIoaXRlbSkpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZCh0aGlzLl9yZW5kZXJlcihpdGVtKSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW5cIik7XHJcblxyXG5leHBvcnQgY29uc3QgcG9wdXBzID0gbWFpbi5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVkaXRGb3JtID0gcG9wdXBzLnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdEZvcm1cIik7XHJcblxyXG5leHBvcnQgY29uc3QgYWRkRm9ybSA9IHBvcHVwcy5xdWVyeVNlbGVjdG9yKFwiI2FkZEZvcm1cIik7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZVBpY3R1cmVGb3JtID0gcG9wdXBzLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZVBpY3R1cmVGb3JtXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRzID0gbWFpbi5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGUgPSBtYWluLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZVwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0XCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVkaXRQaWN0dXJlQnV0dG9uID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVkaXRQb3B1cCA9IFwiI2VkaXRQb3B1cFwiO1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZFBvcHVwID0gXCIjYWRkUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBjZXJ0YWludHlQb3B1cCA9IFwiI2NlcnRhaW50eVBvcHVwXCI7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZVBpY3R1cmVQb3B1cCA9IFwiI3Byb2ZpbGVQaWN0dXJlUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3B1cE5hbWUgPSBwb3B1cHMucXVlcnlTZWxlY3RvcihcIiNpbnB1dE5hbWVcIik7XHJcblxyXG5leHBvcnQgY29uc3QgcG9wdXBEZXNjID0gcG9wdXBzLnF1ZXJ5U2VsZWN0b3IoXCIjaW5wdXREZXNjXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlU3VidGl0bGUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fc3VidGl0bGVcIik7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZUltYWdlID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVQaWN0dXJlRWRpdEJ1dHRvbiA9XHJcbiAgcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3BpY3R1cmVcIik7XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICBzYXZlQnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fc2F2ZV9pbmFjdGl2ZVwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxyXG59O1xyXG4iLCJpbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5cbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanNcIjtcblxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xuXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZVwiO1xuXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcblxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5cbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5cbmltcG9ydCBBcGkgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanNcIjtcblxuaW1wb3J0IHtcbiAgZWRpdEZvcm0sXG4gIGFkZEZvcm0sXG4gIGNhcmRzLFxuICBlZGl0UHJvZmlsZUJ1dHRvbixcbiAgYWRkQ2FyZEJ1dHRvbixcbiAgZWRpdFBvcHVwLFxuICBhZGRQb3B1cCxcbiAgcG9wdXBOYW1lLFxuICBwb3B1cERlc2MsXG4gIHByb2ZpbGVUaXRsZSxcbiAgcHJvZmlsZVN1YnRpdGxlLFxuICBjb25maWcsXG4gIGNlcnRhaW50eVBvcHVwLFxuICBwcm9maWxlUGljdHVyZVBvcHVwLFxuICBlZGl0UGljdHVyZUJ1dHRvbixcbiAgcHJvZmlsZVBpY3R1cmVGb3JtLFxuICBwcm9maWxlSW1hZ2UsXG4gIHByb2ZpbGVQaWN0dXJlRWRpdEJ1dHRvbixcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzXCI7XG5cbmNvbnN0IGVkaXRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGVkaXRGb3JtKTtcblxuY29uc3QgYWRkVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBhZGRGb3JtKTtcblxuY29uc3QgcHJvZmlsZVBpY3R1cmVWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVQaWN0dXJlRm9ybSk7XG5cbmNvbnN0IGNhcmRQcmV2aWV3ID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlUG9wdXBcIik7XG5cbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjNlMzY3MGU0LTg5ZTQtNGI3NC1hYzE4LWM5ODQ2NDIwNjg0MFwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZUVsZW06IHByb2ZpbGVUaXRsZSxcbiAgam9iRWxlbTogcHJvZmlsZVN1YnRpdGxlLFxufSk7XG5cbmFwaVxuICAuZ2V0VXNlckluZm8oKVxuICAudGhlbigoZGF0YSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgIHByb2ZpbGVJbWFnZS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7ZGF0YS5hdmF0YXJ9KWA7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSk7XG5cbmFwaVxuICAuZ2V0SW5pdGlhbENhcmRzKClcbiAgLnRoZW4oKGluaXRpYWxDYXJkcykgPT4ge1xuICAgIGNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGluaXRpYWxDYXJkcyxcbiAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICAgICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBkYXRhLFxuICAgICAgICAgICAgICBoYW5kbGVJbWFnZUNsaWNrOiAoaW1hZ2VEYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgY2FyZFByZXZpZXcub3BlbihpbWFnZURhdGEpO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBjb25maXJtYXRpb25GdW5jdGlvbjogKGNhcmRJZCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbmZpcm1hdGlvblBvcHVwLm9wZW4oKTtcbiAgICAgICAgICAgICAgICBjb25maXJtYXRpb25Qb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgYXBpLmRlbGV0ZUNhcmQoY2FyZElkKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaGFuZGxlTGlrZUZ1bmN0aW9uOiAoY2FyZElkLCBsaWtlQnV0dG9uKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGxpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9saWtlX2FjdGl2YXRlXCIpKSB7XG4gICAgICAgICAgICAgICAgICBhcGlcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUxpa2UoY2FyZElkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9saWtlX2FjdGl2YXRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgIGNhcmQubGlrZU51bWJlckNoZWNrKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgYXBpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRMaWtlKGNhcmRJZClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfbGlrZV9hY3RpdmF0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICBjYXJkLmxpa2VOdW1iZXJDaGVjayh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIG9uTG9hZExpa2VDaGVjazogKGRhdGEsIGxpa2VCdXR0b24pID0+IHtcbiAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2goKG9iaikgPT4ge1xuICAgICAgICAgICAgICAgICAgaWYgKG9iai5faWQgPT09IFwiNWI5MWVjZTEyNzFlMGE4NTU4ZmJlOGUwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9saWtlX2FjdGl2YXRlXCIpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiI2NhcmRcIlxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xuICAgICAgICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBjYXJkc1xuICAgICk7XG5cbiAgICBjb25zdCBhZGRQb3B1cEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShhZGRQb3B1cCwgKGlucHV0VmFsdWVzKSA9PiB7XG4gICAgICBhZGRQb3B1cEZvcm0uaXNMb2FkaW5nKCk7XG4gICAgICBhcGlcbiAgICAgICAgLmFkZE5ld0NhcmQoaW5wdXRWYWx1ZXMpXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShkYXRhKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICB9KVxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgYWRkUG9wdXBGb3JtLmZpbmlzaExvYWRpbmcoKTtcbiAgICAgICAgICBhZGRQb3B1cEZvcm0uY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBhZGRQb3B1cEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIGFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGFkZFBvcHVwRm9ybS5vcGVuKGZhbHNlKTtcbiAgICAgIGFkZFZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIH0pO1xuXG4gICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoaW5pdGlhbENhcmRzKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xuICB9KTtcblxuY29uc3QgY29uZmlybWF0aW9uUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKGNlcnRhaW50eVBvcHVwKTtcblxuY29uZmlybWF0aW9uUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgZWRpdFBvcHVwRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKGVkaXRQb3B1cCwgKGlucHV0VmFsdWVzKSA9PiB7XG4gIGVkaXRQb3B1cEZvcm0uaXNMb2FkaW5nKCk7XG4gIGFwaVxuICAgIC5nZXRVc2VySW5mbygpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBlZGl0UG9wdXBGb3JtLmZpbmlzaExvYWRpbmcoKTtcbiAgICAgIGVkaXRQb3B1cEZvcm0uY2xvc2UoKTtcbiAgICB9KTtcbiAgYXBpLnNldFVzZXJJbmZvKGlucHV0VmFsdWVzKTtcbn0pO1xuXG5lZGl0UG9wdXBGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGVkaXRQaWN0dXJlRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHByb2ZpbGVQaWN0dXJlUG9wdXAsIChhdmF0YXIpID0+IHtcbiAgZWRpdFBpY3R1cmVGb3JtLmlzTG9hZGluZygpO1xuICBhcGlcbiAgICAudXBkYXRlUGZwKGF2YXRhci5hdmF0YXIpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgcHJvZmlsZUltYWdlLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHthdmF0YXIuYXZhdGFyfSlgO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBlZGl0UGljdHVyZUZvcm0uZmluaXNoTG9hZGluZygpO1xuICAgICAgZWRpdFBpY3R1cmVGb3JtLmNsb3NlKCk7XG4gICAgfSk7XG59KTtcblxuZWRpdFBpY3R1cmVGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRQb3B1cEZvcm0ub3Blbih0cnVlKTtcbiAgYXBpLmdldFVzZXJJbmZvKCkudGhlbigoZGF0YSkgPT4ge1xuICAgIHBvcHVwTmFtZS52YWx1ZSA9IGRhdGEubmFtZTtcbiAgICBwb3B1cERlc2MudmFsdWUgPSBkYXRhLmFib3V0O1xuICAgIGVkaXRWYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICBlZGl0VmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICB9KTtcbn0pO1xuXG5lZGl0UGljdHVyZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsICgpID0+IHtcbiAgcHJvZmlsZVBpY3R1cmVFZGl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJwcm9maWxlX19waWN0dXJlX2FjdGl2ZVwiKTtcbn0pO1xuXG5lZGl0UGljdHVyZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgKCkgPT4ge1xuICBwcm9maWxlUGljdHVyZUVkaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcInByb2ZpbGVfX3BpY3R1cmVfYWN0aXZlXCIpO1xufSk7XG5cbmVkaXRQaWN0dXJlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRQaWN0dXJlRm9ybS5vcGVuKGZhbHNlKTtcbiAgcHJvZmlsZVBpY3R1cmVWYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbn0pO1xuXG5jYXJkUHJldmlldy5zZXRFdmVudExpc3RlbmVycygpO1xuXG5lZGl0VmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuYWRkVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxucHJvZmlsZVBpY3R1cmVWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3RpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihkYXRhKSB7XHJcbiAgICB0aGlzLl90aXRsZS50ZXh0Q29udGVudCA9IGRhdGEudGl0bGU7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBkYXRhLmltYWdlO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gYEFuIGltYWdlIG9mICR7ZGF0YS50aXRsZX0uYDtcclxuXHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gY29uZmlnLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gY29uZmlnLmhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfcHJvbWlzZVRoaW5nKHVzZXJBcnJheSwgY2FyZExpc3QpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbCh1c2VyQXJyYXksIGNhcmRMaXN0KTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdDYXJkKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGRhdGEudGl0bGUsXHJcbiAgICAgICAgbGluazogZGF0YS5pbWFnZUxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVQZnAoYXZhdGFyVXJsKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogYXZhdGFyVXJsLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVFbGVtLCBqb2JFbGVtIH0pIHtcclxuICAgIHRoaXMuX25hbWVFbGVtID0gbmFtZUVsZW07XHJcbiAgICB0aGlzLl9qb2JFbGVtID0gam9iRWxlbTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIChpbmZvID0ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbS50ZXh0Q29udGVudCxcclxuICAgICAgYWJvdXQ6IHRoaXMuX2pvYkVsZW0udGV4dENvbnRlbnQsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgdGhpcy5fbmFtZUVsZW0udGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fam9iRWxlbS50ZXh0Q29udGVudCA9IGFib3V0O1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiI2NlcnRhaW50eUNvbmZpcm1cIik7XHJcbiAgfVxyXG5cclxuICBzZXRTdWJtaXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRGdW5jdGlvbiA9IGFjdGlvbjtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9zdWJtaXRGdW5jdGlvbigpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc2F2ZWJ1dHRvblNlbGVjdG9yIiwic2F2ZUJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfdG9nZ2xlSW5wdXRFcnJvciIsInZhbGlkaXR5IiwidmFsaWQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwicmVzZXRWYWxpZGF0aW9uIiwiX2lucHV0TGlzdCIsImZvckVhY2giLCJzb21lIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwidGVtcGxhdGVTZWxlY3RvciIsImRhdGEiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ29uZmlybWF0aW9uIiwiY29uZmlybWF0aW9uRnVuY3Rpb24iLCJoYW5kbGVMaWtlRnVuY3Rpb24iLCJvbkxvYWRMaWtlQ2hlY2siLCJfdGl0bGUiLCJuYW1lIiwiX2ltYWdlIiwibGluayIsIl9saWtlQW1vdW50IiwibGlrZXMiLCJfY2FyZE93bmVySWQiLCJvd25lciIsIl9pZCIsIl9jYXJkSWQiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbiIsIl9jb25maXJtYXRpb25GdW5jdGlvbiIsIl9oYW5kbGVMaWtlRnVuY3Rpb24iLCJfb25Mb2FkTGlrZUNoZWNrIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwicmVtb3ZlQ2FyZCIsIl9lbGVtZW50IiwibGlrZU51bWJlckNoZWNrIiwiYm9vbGVhbiIsIk51bWJlciIsIl9saWtlTnVtYmVyIiwiZ2VuZXJhdGVDYXJkIiwiX3NldEV2ZW50SGFuZGxlcnMiLCJfY2FyZEltYWdlIiwiX2NhcmRUaXRsZSIsIl90cmFzaCIsIl9saWtlQnV0dG9uIiwibGVuZ3RoIiwic3JjIiwiYWx0IiwidGl0bGUiLCJpbWFnZSIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsImNsb3NlIiwiX3BvcHVwIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlQ2xpY2tDbG9zZSIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJzZXRFdmVudExpc3RlbmVycyIsImJpbmQiLCJQb3B1cFdpdGhGb3JtIiwic3VibWl0RnVuY3Rpb24iLCJzdXBlciIsInByZWZpbGxlZCIsImlucHV0IiwidmFsdWUiLCJzZXRUaW1lb3V0IiwiX2Zvcm0iLCJyZXNldCIsIl9zdWJtaXRGdW5jdGlvbiIsIl9zYXZlQnV0dG9uIiwiX2dldElucHV0VmFsdWVzIiwiX2Zvcm1WYWx1ZXMiLCJzZXRTdWJtaXRBY3Rpb24iLCJhY3Rpb24iLCJpc0xvYWRpbmciLCJmaW5pc2hMb2FkaW5nIiwiU2VjdGlvbiIsImNvbnRhaW5lciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsIml0ZW0iLCJwcmVwZW5kIiwicmVuZGVySXRlbXMiLCJhcHBlbmQiLCJtYWluIiwicG9wdXBzIiwiZWRpdEZvcm0iLCJhZGRGb3JtIiwicHJvZmlsZVBpY3R1cmVGb3JtIiwiY2FyZHMiLCJwcm9maWxlIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJhZGRDYXJkQnV0dG9uIiwiZWRpdFBpY3R1cmVCdXR0b24iLCJwb3B1cE5hbWUiLCJwb3B1cERlc2MiLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlU3VidGl0bGUiLCJwcm9maWxlSW1hZ2UiLCJwcm9maWxlUGljdHVyZUVkaXRCdXR0b24iLCJmb3JtU2VsZWN0b3IiLCJlZGl0VmFsaWRhdG9yIiwiYWRkVmFsaWRhdG9yIiwicHJvZmlsZVBpY3R1cmVWYWxpZGF0b3IiLCJjYXJkUHJldmlldyIsImFwaSIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9wcm9taXNlVGhpbmciLCJ1c2VyQXJyYXkiLCJjYXJkTGlzdCIsIlByb21pc2UiLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJyZWplY3QiLCJzdGF0dXMiLCJhZGROZXdDYXJkIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJpbWFnZUxpbmsiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiYWJvdXQiLCJ1cGRhdGVQZnAiLCJhdmF0YXJVcmwiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwidXNlckluZm8iLCJuYW1lRWxlbSIsImpvYkVsZW0iLCJfbmFtZUVsZW0iLCJfam9iRWxlbSIsImluZm8iLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImluaXRpYWxDYXJkcyIsImNhcmRTZWN0aW9uIiwiY2FyZCIsImltYWdlRGF0YSIsImNvbmZpcm1hdGlvblBvcHVwIiwibGlrZUJ1dHRvbiIsImNvbnRhaW5zIiwib2JqIiwiYWRkUG9wdXBGb3JtIiwiaW5wdXRWYWx1ZXMiLCJmaW5hbGx5IiwiX2NvbmZpcm1CdXR0b24iLCJlZGl0UG9wdXBGb3JtIiwiZWRpdFBpY3R1cmVGb3JtIl0sInNvdXJjZVJvb3QiOiIifQ==